{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\steam\\\\OneDrive\\\\\\u0420\\u043E\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u0456\\u043B\\\\Dev\\\\rr\\\\src\\\\BooksPage.js\";\nimport React, { useState, useMemo } from 'react';\nimport './App.css';\nimport Lamp from \"./img/lamp.png\";\nimport Like from \"./img/like.svg\";\nimport Liked from \"./img/liked.svg\";\nimport Box from \"./img/box.png\";\nimport { NavLink } from 'react-router-dom';\nconst BOOKS_PAGE = '1lxN9WC-43jwJhJsC6bJYK63wCNnjOvLSgEMwzrDbkMA';\nconst API_KEY = 'AIzaSyBnsI4y-0LvVLPfxRK1Iu16h-xtxKH4KRc';\n\nfunction BooksPage() {\n  const [books, setBooks] = useState([]);\n  const [favoritesBooksId, setFavoritesId] = useState([]);\n  const [filter, setFilter] = useState('all');\n  const renderedBooks = [];\n  const renderedFav = [];\n\n  const getBooks = async () => {\n    const respons = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${BOOKS_PAGE}/values/Books!A2:D1000?majorDimension=ROWS&key=${API_KEY}`);\n    const data = await respons.json();\n    setBooks(() => {\n      return data.values.map((book, index) => {\n        return {\n          id: index + 100,\n          category: book[0],\n          image: book[1],\n          heading: book[2],\n          description: book[3]\n        };\n      });\n    });\n  };\n\n  const fetchBooks = useMemo(() => getBooks(), []);\n\n  const getCache = () => {\n    setFavoritesId(localStorage.getItem('favorites'));\n  };\n\n  const uploadCache = useMemo(() => getCache(), []);\n  const markup = {\n    book: ({\n      id,\n      heading,\n      description,\n      image\n    }) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: (id + 100).toString(),\n        className: \"book-wrapper book-wrapper__grid\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"book-info\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"book-image-wrapper\",\n        style: {\n          backgroundImage: `url(${image})`\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"book-heading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 19\n        }\n      }, heading), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"book-description\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 19\n        }\n      }, description)), /*#__PURE__*/React.createElement(\"button\", {\n        className: favoritesBooksId.includes(id) ? \"book-to-favorite__disabled\" : \"book-to-favorite\",\n        dataId: id,\n        onClick: () => setFavoritesId(prev => [...prev, id]),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: favoritesBooksId.includes(id) ? Liked : Like,\n        className: \"book-to-favorite-img\",\n        alt: \"Add to favorite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 19\n        }\n      }), favoritesBooksId.includes(id) ? 'Favorite!' : 'Add to favorites'));\n    },\n    favorites: ({\n      id,\n      heading,\n      image\n    }) => {\n      return /*#__PURE__*/React.createElement(\"table\", {\n        className: \"favorites-books\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        className: \"favorites-img\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"favorites-img-img\",\n        src: image,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 49\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"favorites-name\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 19\n        }\n      }, heading), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"favorites-del\",\n        dataId: id,\n        onClick: () => setFavoritesId(favoritesBooksId.filter(listedId => listedId != id)),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 19\n        }\n      }, \"X\")));\n    }\n  };\n\n  const renderFavorites = () => {\n    renderedFav.push(favoritesBooksId.map(id => books.filter(book => book.id == id).map(book => markup.favorites(book))));\n  };\n\n  renderFavorites();\n\n  const renderBooks = books => {\n    renderedBooks.length = 0;\n\n    if (filter === 'all') {\n      books.forEach(book => {\n        renderedBooks.push(markup.book(book));\n      });\n    } else {\n      books.filter(book => book.category === filter).forEach(book => {\n        renderedBooks.push(markup.book(book));\n      });\n    }\n  };\n\n  document.body.addEventListener('click', event => {\n    if (event.path.includes(document.querySelector('.favorites'))) {\n      event.preventDefault();\n      return false;\n    }\n\n    document.querySelector('.favorites-info').classList.remove('favorites-info__visible');\n  });\n  renderBooks(books);\n  const shownBooks = [];\n  const [shownBooksInPage, setShownBooksInPage] = useState(20);\n\n  const showBooks = () => {\n    for (var i = 0; i < shownBooksInPage; i++) {\n      shownBooks.push(renderedBooks[i]);\n    }\n\n    if (renderedBooks.length > shownBooksInPage) {\n      shownBooks.push( /*#__PURE__*/React.createElement(\"button\", {\n        className: \"load-more-btn\",\n        onClick: () => setShownBooksInPage(shownBooksInPage + 20),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }\n      }, \"Load more\"));\n    }\n  };\n\n  showBooks(); // componentWillMount() {\n  //    localStorage.getItem('favorites') && this.setState({\n  //       favorites: JSON.parse(localStorage.getItem('favorites')),\n  //       isLoading: false\n  //    })\n  // }\n\n  const cachedFavorites = () => {\n    localStorage.setItem('favorites', JSON.stringify(favoritesBooksId));\n  };\n\n  const creatingCache = useMemo(() => cachedFavorites(), [favoritesBooksId]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"books\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"header-l\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(NavLink, {\n    to: \"/\",\n    activeClassName: \"is-active\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"back-to-home-btn\",\n    src: Lamp,\n    alt: \"Back to home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"filters\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 16\n    }\n  }, \"Choose what you love\"), /*#__PURE__*/React.createElement(\"select\", {\n    className: \"filter\",\n    onChange: e => {\n      setFilter(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 16\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"all\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 19\n    }\n  }, \"All that we love\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"fantasy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 19\n    }\n  }, \"Fantasy\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"classics\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }\n  }, \"Classics\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"teen\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 19\n    }\n  }, \"Teen\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"fiction\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 19\n    }\n  }, \"Fiction\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"favorites\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"heart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 16\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"favorites-icon-wrapper\",\n    onClick: () => {\n      document.querySelector('.favorites-info').classList.toggle('favorites-info__visible');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"count\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 19\n    }\n  }, favoritesBooksId.length || 0), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"favorites-icon\",\n    src: Box,\n    alt: \"Favorites\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"favorites-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"favorites-books\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"favorites-img\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 28\n    }\n  }, \"Photo\"), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"favorites-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 28\n    }\n  }, \"Book title\"), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"favorites-del-header\",\n    onClick: () => setFavoritesId([]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 28\n    }\n  }, \"Clear\"))), renderedFav)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"books-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 10\n    }\n  }, shownBooks));\n}\n\nexport default BooksPage;","map":{"version":3,"sources":["C:/Users/steam/OneDrive/Робочий стіл/Dev/rr/src/BooksPage.js"],"names":["React","useState","useMemo","Lamp","Box","NavLink","BOOKS_PAGE","API_KEY","BooksPage","books","setBooks","favoritesBooksId","setFavoritesId","filter","setFilter","renderedBooks","renderedFav","getBooks","respons","fetch","data","json","values","map","book","index","id","category","image","heading","description","fetchBooks","getCache","localStorage","getItem","uploadCache","markup","toString","backgroundImage","includes","prev","Liked","Like","favorites","listedId","renderFavorites","push","renderBooks","length","forEach","document","body","addEventListener","event","path","querySelector","preventDefault","classList","remove","shownBooks","shownBooksInPage","setShownBooksInPage","showBooks","i","cachedFavorites","setItem","JSON","stringify","creatingCache","e","target","value","toggle"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,OAA1B,QAAyC,OAAzC;AACA,OAAO,WAAP;AACA,OAAOC,IAAP,MAAiB,gBAAjB;;;AAGA,OAAOC,GAAP,MAAgB,eAAhB;AACA,SAAQC,OAAR,QAAsB,kBAAtB;AAGA,MAAMC,UAAU,GAAG,8CAAnB;AACA,MAAMC,OAAO,GAAG,yCAAhB;;AAEA,SAASC,SAAT,GAAqB;AAClB,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBT,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACU,gBAAD,EAAmBC,cAAnB,IAAqCX,QAAQ,CAAC,EAAD,CAAnD;AACA,QAAM,CAACY,MAAD,EAASC,SAAT,IAAsBb,QAAQ,CAAC,KAAD,CAApC;AACA,QAAMc,aAAa,GAAG,EAAtB;AACA,QAAMC,WAAW,GAAG,EAApB;;AAEA,QAAMC,QAAQ,GAAG,YAAY;AAC7B,UAAMC,OAAO,GAAG,MAAMC,KAAK,CAAE,iDAAgDb,UAAW,kDAAiDC,OAAQ,EAAtH,CAA3B;AACA,UAAMa,IAAI,GAAG,MAAMF,OAAO,CAACG,IAAR,EAAnB;AACAX,IAAAA,QAAQ,CAAC,MAAI;AAAC,aAAOU,IAAI,CAACE,MAAL,CAAYC,GAAZ,CAAgB,CAACC,IAAD,EAAOC,KAAP,KAAe;AACjD,eAAO;AACJC,UAAAA,EAAE,EAAED,KAAK,GAAG,GADR;AAEJE,UAAAA,QAAQ,EAAEH,IAAI,CAAC,CAAD,CAFV;AAGJI,UAAAA,KAAK,EAAEJ,IAAI,CAAC,CAAD,CAHP;AAIJK,UAAAA,OAAO,EAAEL,IAAI,CAAC,CAAD,CAJT;AAKJM,UAAAA,WAAW,EAAEN,IAAI,CAAC,CAAD;AALb,SAAP;AAOD,OARmB,CAAP;AAQV,KARI,CAAR;AASC,GAZD;;AAaA,QAAMO,UAAU,GAAG7B,OAAO,CAAC,MAAMe,QAAQ,EAAf,EAAmB,EAAnB,CAA1B;;AAEA,QAAMe,QAAQ,GAAG,MAAM;AACjBpB,IAAAA,cAAc,CAACqB,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAD,CAAd;AACL,GAFD;;AAGA,QAAMC,WAAW,GAAGjC,OAAO,CAAC,MAAM8B,QAAQ,EAAf,EAAmB,EAAnB,CAA3B;AAEA,QAAMI,MAAM,GAAG;AACZZ,IAAAA,IAAI,EAAE,CAAC;AAACE,MAAAA,EAAD;AAAKG,MAAAA,OAAL;AAAcC,MAAAA,WAAd;AAA2BF,MAAAA;AAA3B,KAAD,KAAuC;AAC1C,0BACG;AAAK,QAAA,GAAG,EAAE,CAACF,EAAE,GAAC,GAAJ,EAASW,QAAT,EAAV;AAA+B,QAAA,SAAS,EAAC,iCAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACG;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACG;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAoC,QAAA,KAAK,EAAE;AAACC,UAAAA,eAAe,EAAG,OAAMV,KAAM;AAA/B,SAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADH,eAGG;AAAI,QAAA,SAAS,EAAC,cAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACIC,OADJ,CAHH,eAMG;AAAK,QAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACIC,WADJ,CANH,CADH,eAWG;AAAQ,QAAA,SAAS,EAAEnB,gBAAgB,CAAC4B,QAAjB,CAA0Bb,EAA1B,IAAgC,4BAAhC,GAA8D,kBAAjF;AACA,QAAA,MAAM,EAAEA,EADR;AACY,QAAA,OAAO,EAAE,MAAMd,cAAc,CAAC4B,IAAI,IAAI,CAAC,GAAGA,IAAJ,EAAUd,EAAV,CAAT,CADzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEG;AAAK,QAAA,GAAG,EAAEf,gBAAgB,CAAC4B,QAAjB,CAA0Bb,EAA1B,IAAgCe,KAAhC,GAAwCC,IAAlD;AAAwD,QAAA,SAAS,EAAC,sBAAlE;AAAyF,QAAA,GAAG,EAAC,iBAA7F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFH,EAGI/B,gBAAgB,CAAC4B,QAAjB,CAA0Bb,EAA1B,IAAgC,WAAhC,GAA8C,kBAHlD,CAXH,CADH;AAmBF,KArBW;AAsBZiB,IAAAA,SAAS,EAAE,CAAC;AAACjB,MAAAA,EAAD;AAAKG,MAAAA,OAAL;AAAcD,MAAAA;AAAd,KAAD,KAA0B;AAClC,0BACG;AAAO,QAAA,SAAS,EAAC,iBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACG;AAAI,QAAA,SAAS,EAAC,eAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAA8B;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAmC,QAAA,GAAG,EAAEA,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAA9B,CADH,eAEG;AAAI,QAAA,SAAS,EAAC,gBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAgCC,OAAhC,CAFH,eAGG;AAAI,QAAA,SAAS,EAAC,eAAd;AAA8B,QAAA,MAAM,EAAEH,EAAtC;AAA0C,QAAA,OAAO,EAAE,MACnDd,cAAc,CACXD,gBAAgB,CAACE,MAAjB,CAAwB+B,QAAQ,IAAIA,QAAQ,IAAIlB,EAAhD,CADW,CADd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAHH,CADH,CADH;AAaF;AApCW,GAAf;;AAuCA,QAAMmB,eAAe,GAAG,MAAK;AAAC7B,IAAAA,WAAW,CAAC8B,IAAZ,CAAiBnC,gBAAgB,CAACY,GAAjB,CAAqBG,EAAE,IAAIjB,KAAK,CAACI,MAAN,CAAaW,IAAI,IAAIA,IAAI,CAACE,EAAL,IAAWA,EAAhC,EAAoCH,GAApC,CAAwCC,IAAI,IAAIY,MAAM,CAACO,SAAP,CAAiBnB,IAAjB,CAAhD,CAA3B,CAAjB;AAAsH,GAApJ;;AACAqB,EAAAA,eAAe;;AAEf,QAAME,WAAW,GAAItC,KAAD,IAAW;AAC5BM,IAAAA,aAAa,CAACiC,MAAd,GAAuB,CAAvB;;AACA,QAAInC,MAAM,KAAK,KAAf,EAAqB;AAClBJ,MAAAA,KAAK,CAACwC,OAAN,CAAezB,IAAD,IAAU;AAACT,QAAAA,aAAa,CAAC+B,IAAd,CAAmBV,MAAM,CAACZ,IAAP,CAAYA,IAAZ,CAAnB;AAAsC,OAA/D;AACF,KAFD,MAEO;AACJf,MAAAA,KAAK,CAACI,MAAN,CAAaW,IAAI,IAAIA,IAAI,CAACG,QAAL,KAAkBd,MAAvC,EAA+CoC,OAA/C,CAAwDzB,IAAD,IAAU;AAACT,QAAAA,aAAa,CAAC+B,IAAd,CAAmBV,MAAM,CAACZ,IAAP,CAAYA,IAAZ,CAAnB;AAAsC,OAAxG;AACF;AACH,GAPD;;AASA0B,EAAAA,QAAQ,CAACC,IAAT,CAAcC,gBAAd,CAA+B,OAA/B,EAAyCC,KAAD,IAAW;AAChD,QAAIA,KAAK,CAACC,IAAN,CAAWf,QAAX,CAAoBW,QAAQ,CAACK,aAAT,CAAuB,YAAvB,CAApB,CAAJ,EAA+D;AAC5DF,MAAAA,KAAK,CAACG,cAAN;AACA,aAAO,KAAP;AACF;;AACAN,IAAAA,QAAQ,CAACK,aAAT,CAAuB,iBAAvB,EAA0CE,SAA1C,CAAoDC,MAApD,CAA2D,yBAA3D;AACF,GANF;AAQAX,EAAAA,WAAW,CAACtC,KAAD,CAAX;AAEA,QAAMkD,UAAU,GAAG,EAAnB;AACA,QAAM,CAACC,gBAAD,EAAmBC,mBAAnB,IAA0C5D,QAAQ,CAAC,EAAD,CAAxD;;AACD,QAAM6D,SAAS,GAAG,MAAM;AACpB,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACH,gBAAf,EAAiCG,CAAC,EAAlC,EAAqC;AACrCJ,MAAAA,UAAU,CAACb,IAAX,CAAgB/B,aAAa,CAACgD,CAAD,CAA7B;AACC;;AACJ,QAAGhD,aAAa,CAACiC,MAAd,GAAuBY,gBAA1B,EAA4C;AAACD,MAAAA,UAAU,CACnDb,IADyC,eACpC;AAAQ,QAAA,SAAS,EAAC,eAAlB;AAAkC,QAAA,OAAO,EAAE,MAAMe,mBAAmB,CAACD,gBAAgB,GAAC,EAAlB,CAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADoC;AAC2E;AACxH,GAND;;AAOAE,EAAAA,SAAS,GAjGU,CAmGlB;AACA;AACA;AACA;AACA;AACA;;AACA,QAAME,eAAe,GAAG,MAAM;AAC3B/B,IAAAA,YAAY,CAACgC,OAAb,CAAqB,WAArB,EAAkCC,IAAI,CAACC,SAAL,CAAexD,gBAAf,CAAlC;AACF,GAFD;;AAGA,QAAMyD,aAAa,GAAGlE,OAAO,CAAC,MAAM8D,eAAe,EAAtB,EAA0B,CAACrD,gBAAD,CAA1B,CAA7B;AAEA,sBACG;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,OAAD;AAAS,IAAA,EAAE,EAAC,GAAZ;AAAgB,IAAA,eAAe,EAAC,WAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAkC,IAAA,GAAG,EAAER,IAAvC;AAA6C,IAAA,GAAG,EAAC,cAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,CADJ,eAIA;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADH,eAEG;AAAQ,IAAA,SAAS,EAAC,QAAlB;AAA2B,IAAA,QAAQ,EAAGkE,CAAD,IAAO;AAACvD,MAAAA,SAAS,CAACuD,CAAC,CAACC,MAAF,CAASC,KAAV,CAAT;AAA0B,KAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAQ,IAAA,KAAK,EAAC,KAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADH,eAEG;AAAQ,IAAA,KAAK,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAFH,eAGG;AAAQ,IAAA,KAAK,EAAC,UAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHH,eAIG;AAAQ,IAAA,KAAK,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAJH,eAKG;AAAQ,IAAA,KAAK,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eALH,CAFH,CAJA,CADH,eAgBG;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAwC,IAAA,OAAO,EAAE,MAAM;AACpDrB,MAAAA,QAAQ,CAACK,aAAT,CAAuB,iBAAvB,EAA0CE,SAA1C,CAAoDe,MAApD,CAA2D,yBAA3D;AACF,KAFD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAGA;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAwB7D,gBAAgB,CAACqC,MAAjB,IAA2B,CAAnD,CAHA,eAIA;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAgC,IAAA,GAAG,EAAE5C,GAArC;AAA0C,IAAA,GAAG,EAAC,WAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJA,CADH,eAOG;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAO,IAAA,SAAS,EAAC,iBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG;AAAI,IAAA,SAAS,EAAC,eAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADH,eAEG;AAAI,IAAA,SAAS,EAAC,gBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFH,eAGG;AAAI,IAAA,SAAS,EAAC,sBAAd;AAAqC,IAAA,OAAO,EAAE,MAAMQ,cAAc,CAAC,EAAD,CAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAHH,CADN,CADA,EAQCI,WARD,CAPH,CADH,CAhBH,CADH,eAsCG;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI2C,UADJ,CAtCH,CADH;AA4CF;;AAED,eAAenD,SAAf","sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport './App.css';\r\nimport Lamp from \"./img/lamp.png\"\r\nimport Like from \"./img/like.svg\";\r\nimport Liked from \"./img/liked.svg\";\r\nimport Box from \"./img/box.png\";\r\nimport {NavLink} from 'react-router-dom';\r\n\r\n\r\nconst BOOKS_PAGE = '1lxN9WC-43jwJhJsC6bJYK63wCNnjOvLSgEMwzrDbkMA'\r\nconst API_KEY = 'AIzaSyBnsI4y-0LvVLPfxRK1Iu16h-xtxKH4KRc'\r\n\r\nfunction BooksPage() {\r\n   const [books, setBooks] = useState([])\r\n   const [favoritesBooksId, setFavoritesId] = useState([])\r\n   const [filter, setFilter] = useState('all')\r\n   const renderedBooks = []\r\n   const renderedFav = []\r\n\r\n   const getBooks = async () => {\r\n   const respons = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${BOOKS_PAGE}/values/Books!A2:D1000?majorDimension=ROWS&key=${API_KEY}`)\r\n   const data = await respons.json()\r\n   setBooks(()=>{return data.values.map((book, index)=>{\r\n      return {\r\n         id: index + 100,\r\n         category: book[0],\r\n         image: book[1],\r\n         heading: book[2],\r\n         description: book[3],\r\n      }\r\n    })})\r\n   }\r\n   const fetchBooks = useMemo(() => getBooks(), []);\r\n\r\n   const getCache = () => {\r\n         setFavoritesId(localStorage.getItem('favorites'))\r\n   }\r\n   const uploadCache = useMemo(() => getCache(), [])\r\n\r\n   const markup = {\r\n      book: ({id, heading, description, image}) => {\r\n         return (\r\n            <div key={(id+100).toString()} className=\"book-wrapper book-wrapper__grid\">\r\n               <div className=\"book-info\">\r\n                  <div className=\"book-image-wrapper\" style={{backgroundImage: `url(${image})`}}>\r\n                  </div>\r\n                  <h3 className=\"book-heading\">\r\n                     {heading}\r\n                  </h3>\r\n                  <div className=\"book-description\">\r\n                     {description}\r\n                  </div>\r\n               </div>\r\n               <button className={favoritesBooksId.includes(id) ? \"book-to-favorite__disabled\": \"book-to-favorite\"} \r\n               dataId={id} onClick={() => setFavoritesId(prev => [...prev, id])}> \r\n                  <img src={favoritesBooksId.includes(id) ? Liked : Like} className=\"book-to-favorite-img\" alt=\"Add to favorite\"/>\r\n                  {favoritesBooksId.includes(id) ? 'Favorite!' : 'Add to favorites'}\r\n               </button>\r\n            </div>\r\n         )\r\n      },\r\n      favorites: ({id, heading, image}) => {\r\n         return(\r\n            <table className=\"favorites-books\">\r\n               <tr>\r\n                  <td className=\"favorites-img\"><img className=\"favorites-img-img\" src={image}/></td>\r\n                  <td className=\"favorites-name\">{heading}</td>\r\n                  <td className=\"favorites-del\" dataId={id} onClick={() => \r\n                  setFavoritesId(\r\n                     favoritesBooksId.filter(listedId => listedId != id),\r\n                     )}\r\n                     >X</td>\r\n               </tr>\r\n            </table>\r\n         )\r\n      }\r\n   } \r\n   \r\n   const renderFavorites = () =>{renderedFav.push(favoritesBooksId.map(id => books.filter(book => book.id == id).map(book => markup.favorites(book))))}\r\n   renderFavorites()\r\n   \r\n   const renderBooks = (books) => {\r\n      renderedBooks.length = 0\r\n      if (filter === 'all'){\r\n         books.forEach((book) => {renderedBooks.push(markup.book(book))})\r\n      } else {\r\n         books.filter(book => book.category === filter).forEach((book) => {renderedBooks.push(markup.book(book))})\r\n      }\r\n   }\r\n\r\n   document.body.addEventListener('click', (event) => {\r\n      if (event.path.includes(document.querySelector('.favorites'))) {\r\n         event.preventDefault();\r\n         return false;\r\n      }\r\n       document.querySelector('.favorites-info').classList.remove('favorites-info__visible')\r\n    })\r\n   \r\n   renderBooks(books)\r\n\r\n   const shownBooks = []\r\n   const [shownBooksInPage, setShownBooksInPage] = useState(20)\r\n  const showBooks = () => {\r\n      for(var i=0; i<shownBooksInPage; i++){\r\n      shownBooks.push(renderedBooks[i])\r\n      }\r\n   if(renderedBooks.length > shownBooksInPage) {shownBooks\r\n      .push(<button className=\"load-more-btn\" onClick={() => setShownBooksInPage(shownBooksInPage+20)}>Load more</button>)}\r\n  }\r\n  showBooks()\r\n\r\n   // componentWillMount() {\r\n   //    localStorage.getItem('favorites') && this.setState({\r\n   //       favorites: JSON.parse(localStorage.getItem('favorites')),\r\n   //       isLoading: false\r\n   //    })\r\n   // }\r\n   const cachedFavorites = () => {\r\n      localStorage.setItem('favorites', JSON.stringify(favoritesBooksId))\r\n   }\r\n   const creatingCache = useMemo(() => cachedFavorites(), [favoritesBooksId])\r\n\r\n   return(\r\n      <div className='books'>\r\n         <div className=\"header\">\r\n            <div className=\"header-l\">\r\n                <NavLink to=\"/\" activeClassName='is-active'>\r\n                <img className=\"back-to-home-btn\" src={Lamp} alt=\"Back to home\" />\r\n               </NavLink>\r\n            <div className=\"filters\">\r\n               <p>Choose what you love</p>\r\n               <select className=\"filter\" onChange={(e) => {setFilter(e.target.value)}}>\r\n                  <option value=\"all\">All that we love</option>\r\n                  <option value=\"fantasy\">Fantasy</option>\r\n                  <option value=\"classics\">Classics</option>\r\n                  <option value=\"teen\">Teen</option>\r\n                  <option value=\"fiction\">Fiction</option>\r\n               </select>\r\n               </div>\r\n            </div>\r\n            <div className=\"favorites\">\r\n               <div className=\"heart\">\r\n                  <div className=\"favorites-icon-wrapper\" onClick={() => {\r\n                     document.querySelector('.favorites-info').classList.toggle('favorites-info__visible')\r\n                  }}>\r\n                  <div className=\"count\">{favoritesBooksId.length || 0}</div>  \r\n                  <img className=\"favorites-icon\" src={Box} alt=\"Favorites\" />\r\n               </div>\r\n                  <div className=\"favorites-info\">\r\n                  <table className=\"favorites-books\">\r\n                        <tr>\r\n                           <td className=\"favorites-img\">Photo</td>\r\n                           <td className=\"favorites-name\">Book title</td>\r\n                           <td className=\"favorites-del-header\" onClick={() => setFavoritesId([])}>Clear</td>\r\n                        </tr>\r\n               </table>\r\n                  {renderedFav} \r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n         <div className=\"books-list\">\r\n            {shownBooks}\r\n         </div>\r\n      </div> \r\n   )\r\n}\r\n\r\nexport default BooksPage;"]},"metadata":{},"sourceType":"module"}